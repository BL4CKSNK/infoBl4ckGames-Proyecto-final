import{r as t,j as e}from"./index-CT-9_id-.js";import{L as w}from"./LayaoutAdmin-b_Mhy4Wx.js";import{J as N,M as v,B as J,a5 as E}from"./MainLayaout--hj295c2.js";import{T}from"./toast.esm-BPGPX-aO.js";import{I as u}from"./inputtext.esm-CaMnLbjR.js";import"./index.esm-ka6OvFs3.js";import"./index.esm-CTkIKXvg.js";import"./index.esm-QBDj5i6w.js";function C(){const[m,x]=t.useState([]),[l,h]=t.useState(""),[p,g]=t.useState(null),i=t.useRef(null),[n,c]=t.useState({Titulo:"",Descripcion:"",Precio:"",Recomendados:"",Minimos:"",Imagen:null,FechaLanzamiento:""});t.useEffect(()=>{fetch(N).then(o=>o.text()).then(o=>{const a=o.substring(o.indexOf("["));try{const s=JSON.parse(a);x(s)}catch(s){console.error("Error al analizar JSON:",s)}}).catch(o=>{console.error("Error en la solicitud:",o)})},[]),t.useEffect(()=>{if(l){const o=m.find(a=>a.idJuego===l);g(o),c({Titulo:o.Titulo,Descripcion:o.Descripcion,Precio:o.Precio,Recomendados:o.Recomendados,Minimos:o.Minimos,Imagen:null,FechaLanzamiento:o.FechaLanzamiento})}},[l,m]);const f=o=>{const a=o.target.value;h(a)},r=o=>{const{name:a,value:s}=o.target;c({...n,[a]:s})},b=o=>{c({...n,Imagen:o.target.files[0]})},y=o=>{o.preventDefault();const a=new FormData;a.append("Juego_ID",l),a.append("Titulo",n.Titulo),a.append("Descripcion",n.Descripcion),a.append("Precio",n.Precio),a.append("Recomendados",n.Recomendados),a.append("Minimos",n.Minimos),n.Imagen&&a.append("Imagen",n.Imagen),a.append("FechaLanzamiento",n.FechaLanzamiento),fetch(E,{method:"POST",body:a}).then(s=>s.text()).then(s=>{const j=s.substring(s.indexOf("{"),s.lastIndexOf("}")+1);try{const d=JSON.parse(j);d.success?(i.current.show({severity:"success",summary:"Éxito",detail:"Juego actualizado correctamente",life:3e3}),c({Titulo:"",Descripcion:"",Precio:"",Recomendados:"",Minimos:"",Imagen:null,FechaLanzamiento:""}),h("")):i.current.show({severity:"error",summary:"Error",detail:d.message,life:3e3})}catch(d){console.error("Error al analizar JSON:",d),i.current.show({severity:"error",summary:"Error",detail:"Error al analizar la respuesta del servidor",life:3e3})}}).catch(s=>{console.error("Error en la solicitud:",s),i.current.show({severity:"error",summary:"Error",detail:"Error en la solicitud",life:3e3})})};return e.jsx(e.Fragment,{children:e.jsx(v,{children:e.jsxs(w,{children:[e.jsx(T,{ref:i,position:"bottom-center",className:" text-white"}),e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Formulario de Edición de Juegos"}),e.jsxs("form",{onSubmit:y,children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Juego:"}),e.jsxs("select",{value:l,onChange:f,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",children:[e.jsx("option",{value:"",children:"Seleccione un juego"}),m.map(o=>e.jsx("option",{value:o.idJuego,children:o.Titulo},o.idJuego))]})]}),p&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Título:"}),e.jsx(u,{name:"Titulo",value:n.Titulo,onChange:r,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Descripción:"}),e.jsx("textarea",{name:"Descripcion",value:n.Descripcion,onChange:r,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Precio:"}),e.jsx(u,{name:"Precio",value:n.Precio,onChange:r,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Requisitos Recomendados:"}),e.jsx("textarea",{name:"Recomendados",value:n.Recomendados,onChange:r,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Requisitos Mínimos:"}),e.jsx("textarea",{name:"Minimos",value:n.Minimos,onChange:r,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Fecha de Lanzamiento:"}),e.jsx(u,{type:"date",name:"FechaLanzamiento",value:n.FechaLanzamiento,onChange:r,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Imagen:"}),e.jsx(u,{type:"file",onChange:b,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"})]}),e.jsx(J,{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",children:"Guardar cambios"})]})]})]})})})}export{C as default};
