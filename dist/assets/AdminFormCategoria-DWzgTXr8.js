import{r as o,j as t}from"./index-CT-9_id-.js";import{J as y,O as C,M as j,B as E,Q as N}from"./MainLayaout--hj295c2.js";import{L as v}from"./LayaoutAdmin-b_Mhy4Wx.js";import{T as S}from"./toast.esm-BPGPX-aO.js";import"./index.esm-ka6OvFs3.js";import"./index.esm-CTkIKXvg.js";import"./index.esm-QBDj5i6w.js";function F(){const[m,h]=o.useState([]),[g,c]=o.useState([]),[d,u]=o.useState(""),[i,l]=o.useState([]),a=o.useRef(null);o.useEffect(()=>{fetch(y).then(e=>e.text()).then(e=>{const s=e.substring(e.indexOf("["));try{const r=JSON.parse(s);h(r)}catch(r){console.error("Error al analizar JSON:",r)}}).catch(e=>{console.error("Error en la solicitud:",e)})},[]),o.useEffect(()=>{fetch(C).then(e=>e.text()).then(e=>{if(e==="No hay categorías")c([]);else{const s=e.split(";").map(r=>{const[n,b]=r.split(",");return{idCategoria:n,Nombre:b}});c(s)}}).catch(e=>console.error("Error al obtener categorías:",e))},[]);const x=e=>{const s=e.target.value;u(s)},f=e=>{const s=e.target.value;e.target.checked?l([...i,s]):l(i.filter(r=>r!==s))},p=async e=>{e.preventDefault();const s=new FormData;s.append("idJuego",d),i.forEach(r=>{s.append("idCategoria[]",r)});try{const r=await fetch(N,{method:"POST",body:s});if(r.ok){const n=await r.text();n.includes("success")?(a.current.show({severity:"success",summary:"Éxito",detail:"Categorías insertadas exitosamente",life:3e3}),u(""),l([])):(a.current.show({severity:"error",summary:"Error",detail:n,life:3e3}),console.error("Error al insertar categorías:",n))}else a.current.show({severity:"error",summary:"Error",detail:`Error en la solicitud: ${r.status}`,life:3e3}),console.error("Error en la solicitud:",r.status)}catch(r){a.current.show({severity:"error",summary:"Error",detail:"Error de red",life:3e3}),console.error("Error de red:",r)}};return t.jsx(t.Fragment,{children:t.jsx(j,{children:t.jsxs(v,{children:[t.jsx(S,{ref:a,position:"bottom-center",className:" text-white"}),t.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Formulario de Inserción de Categorías"}),t.jsxs("form",{onSubmit:p,children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Juego:"}),t.jsxs("select",{value:d,onChange:x,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",children:[t.jsx("option",{value:"",children:"Seleccione un juego"}),m.map(e=>t.jsx("option",{value:e.idJuego,children:e.Titulo},e.idJuego))]})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Categorías:"}),g.map((e,s)=>t.jsx("div",{className:"mb-2",children:s!==0&&t.jsxs(t.Fragment,{children:[t.jsx("input",{type:"checkbox",id:`categoria-${e.idCategoria}`,value:e.idCategoria,checked:i.includes(e.idCategoria),onChange:f,className:"mr-2"}),t.jsx("label",{htmlFor:`categoria-${e.idCategoria}`,className:"text-gray-700",children:e.Nombre})]})},e.idCategoria))]}),t.jsx(E,{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",children:"Insertar Categoría en el juego"})]})]})})})}export{F as default};
