import{r,j as s,L as U}from"./index-CT-9_id-.js";import{h as E,r as O,M as T,B as f,P as A,s as P,t as R}from"./MainLayaout--hj295c2.js";import{I as x}from"./inputtext.esm-CaMnLbjR.js";import{T as k}from"./toast.esm-BPGPX-aO.js";import"./index.esm-CTkIKXvg.js";import"./index.esm-QBDj5i6w.js";const C=a=>{const i=`; ${document.cookie}`.split(`; ${a}=`);if(i.length===2)return i.pop().split(";").shift()};function F(){const[a,n]=r.useState(null),[i,p]=r.useState("");document.title=`Perfil ${i}`;const[b,j]=r.useState(""),l=C("id"),[g,v]=r.useState(null),[N,w]=r.useState([]),m=r.useRef(null);r.useEffect(()=>{fetch(`${E}?idUsuario=${l}`).then(e=>e.text()).then(e=>{const t=JSON.parse(e.substring(e.indexOf("{"),e.lastIndexOf("}")+1));p(t.nombreUsuario),j(t.correo),n(t.imgPerfil)}).catch(e=>{console.error("Error al obtener datos del usuario:",e)}),fetch(`${O}?idUsuario=${l}`).then(e=>e.text()).then(e=>{const t=e.indexOf("["),o=e.lastIndexOf("]")+1,c=e.substring(t,o),u=JSON.parse(c);w(u)}).catch(e=>{console.error("Error al obtener el inventario del usuario:",e)})},[l]);const h=e=>{const t=e.target.files[0],o=URL.createObjectURL(t);n(o),v(t)},y=async e=>{e.preventDefault();const t=new FormData;t.append("imgPerfil",g),t.append("idUsuarios",l);try{const o=await fetch(A,{method:"POST",body:t});if(o.ok){const c=await o.text(),u=c.indexOf("{"),S=c.substring(u),d=JSON.parse(S);d.success?(n(P+d.rutaImagen),window.location.reload(!1)):(m.current.show({severity:"error",summary:"Error",detail:d.message,life:3e3}),console.error("Error:",d.message))}else console.error("Error en la solicitud:",o.status)}catch(o){console.error("Error de red:",o)}},I=async()=>{try{const e=await fetch(R,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idUsuario:l})});e.ok?(n(null),window.location.reload(!1)):console.error("Error al eliminar la foto de perfil:",e.statusText)}catch(e){console.error("Error de red:",e)}};return s.jsx(s.Fragment,{children:s.jsxs(T,{children:[s.jsx(k,{ref:m,position:"bottom-center",className:" text-white"}),s.jsxs("div",{className:" perfil mt-28 p-6  rounded-lg shadow-xl relative text-white font-bold  mb-96  ",children:[s.jsx("h1",{className:"text-2xl font-bold mb-4 flex justify-center",children:"Perfil de Usuario"}),s.jsxs("div",{className:"flex items-center justify-center gap-16 mb-4",children:[s.jsxs("div",{className:"relative mb-6",children:[a&&s.jsxs("div",{className:"relative group",children:[s.jsx("img",{src:a,alt:"Imagen de perfil",className:"rounded-full w-40 h-40 object-cover transition duration-300 ease-in-out transform group-hover:opacity-80 hover:shadow-lg"}),s.jsx(x,{type:"file",onChange:h,className:"absolute inset-0 opacity-0 cursor-pointer w-full h-full"}),s.jsx(f,{className:"absolute top-2 right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center",onClick:e=>{e.stopPropagation(),I()},children:"X"})]}),!a&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold mb-2",children:"Seleccionar imagen de perfil:"}),s.jsx(x,{type:"file",onChange:h,className:"rounded-full w-40 h-40 object-cover transition duration-300 ease-in-out transform group-hover:opacity-80 hover:shadow-lg bg-white"})]})]}),s.jsx("div",{children:s.jsxs("form",{onSubmit:y,children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("label",{className:"block text-sm font-bold mb-2",children:"Nombre de Usuario:"}),s.jsx("p",{children:i})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("label",{className:"block  text-sm font-bold mb-2",children:"Correo ElectrÃ³nico:"}),s.jsx("p",{children:b})]}),a&&s.jsx(f,{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",children:"Actualizar Perfil"})]})})]}),s.jsx("h2",{className:"text-xl font-bold flex justify-center mt-10 mb-10",children:"Inventario:"}),s.jsx("div",{className:"flex flex-wrap gap-10 justify-center cursor-pointer  font-bold",children:N.map(e=>s.jsxs(U,{to:`/juego/${e.idJuego}`,className:"border border-gray-300 rounded-lg shadow-md w-48 overflow-hidden transform transition duration-300 ease-in-out hover:scale-105 hover:shadow-2xl",children:[s.jsx("img",{src:e.Imagen,alt:e.Titulo,className:"w-full h-20   object-cover relative border rounded-xl overflow-hidden"}),s.jsx("div",{className:"p-5  ",children:s.jsx("h3",{className:"mt-0 text-sm",children:e.Titulo})})]},e.idJuego))})]})]})})}export{F as default};
